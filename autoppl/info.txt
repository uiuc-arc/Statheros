Forked from https://github.com/JamesYang007/autoppl/commit/13c911874028295395aced1a75952b8bcc87474a
